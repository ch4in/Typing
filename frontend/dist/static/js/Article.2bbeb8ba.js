(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Article"],{"245f":function(t,e,s){"use strict";var i=s("c7aa"),n=s.n(i);n.a},"3e3e":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"article"},[s("Recorder",{attrs:{speed:t.speed,unit:t.articleType,time:t.timeStr,percentage:t.percentage,isPause:t.isPause,pauseTime:t.pauseTime},on:{timePause:t.timePause}}),s("h1",[t._v(t._s(t.aiticleTitle))]),t._l(t.lineList,(function(e,i){return s("div",{key:i},[s("div",{staticClass:"line"},t._l(e,(function(e,n){return s("span",{key:n,class:[{Error:t.isError[i][n]},{Right:t.isRight[i][n]}]},[t._v(t._s(e))])})),0),s("el-input",{ref:"inputRef",refInFor:!0,staticClass:"ipt",attrs:{disabled:t.isDisabled[i]},on:{focus:function(e){return t.focus_line(i)}},nativeOn:{keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete","Del"])?null:t.key_delete.apply(null,arguments)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.key_enter.apply(null,arguments)}],"!paste":function(t){return t.preventDefault(),(!1).apply(null,arguments)}},model:{value:t.inputList[i],callback:function(e){t.$set(t.inputList,i,e)},expression:"inputList[i]"}})],1)})),s("SubmitDialog",{attrs:{visible:t.isDialogVisible,testInfo:t.testInfo}}),s("el-backtop",{attrs:{target:".article"}})],2)},n=[],o=(s("28a5"),s("6d7e")),r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"SubmitDialog"},[s("el-dialog",{attrs:{title:"结 果",visible:t.visible,width:"400px"},on:{"update:visible":function(e){t.visible=e},open:t.submit,closed:t.handleBack}},[s("el-row",[s("el-col",{attrs:{span:12}},[t._v("学校："+t._s(this.$store.state.user.school))]),s("el-col",{attrs:{span:12}},[t._v("班级："+t._s(this.$store.state.user.stuClass))]),s("el-col",{attrs:{span:12}},[t._v("姓名："+t._s(this.$store.state.user.stuName))]),s("el-col",{attrs:{span:12}},[t._v("\n        速度："+t._s(t.testInfo.speed)+"\n        "),"Cn"===t.testInfo.type?s("span",[t._v("WPM")]):s("span",[t._v("KPM")])]),s("el-col",{attrs:{span:12}},[t._v("用时："+t._s(t.time))]),s("el-col",{attrs:{span:12}},[t._v("正确率："+t._s(t.testInfo.correctRate)+"%")])],1),s("el-row",[s("el-col",{attrs:{span:24}},[s("el-button",{attrs:{type:"primary"},on:{click:t.handleBack}},[t._v("确 定")])],1)],1)],1)],1)},l=[],a={name:"SubmitDialog",props:["visible","testInfo"],data:function(){return{}},computed:{time:function(){var t=Math.floor(this.testInfo.time/60),e=Math.floor(this.testInfo.time)-60*t;return t<=9&&(t="0"+t),e<=9&&(e="0"+e),t+"分"+e+"秒"}},methods:{submit:function(){var t;t=1==this.$store.state.isPractice?new URLSearchParams({title:this.$store.state.article.title,school:this.$store.state.user.school,stuClass:this.$store.state.user.stuClass,stuName:this.$store.state.user.stuName,speed:this.testInfo.speed,correctRate:this.testInfo.correctRate,score:this.testInfo.score}):new URLSearchParams({testID:this.$store.state.testInfo.testID,stuID:this.$store.state.user.stuID,speed:this.testInfo.speed,correctRate:this.testInfo.correctRate,score:this.testInfo.score}),axios({url:"/post_testResult/",method:"post",data:t,responseType:"text"}).then((function(t){})).catch((function(t){console.log("error")}))},handleBack:function(){this.$store.state.isPractice?this.$router.push("articleList"):this.$router.push("testList")}}},c=a,h=s("2877"),u=Object(h["a"])(c,r,l,!1,null,"f285121c",null),f=u.exports,p={name:"Article",data:function(){return{aiticleTitle:this.$store.state.article["title"],article:this.$store.state.article["content"],articleType:this.$store.state.article["type"],lineList:[""],inputList:[],isError:[[]],isRight:[[]],isDisabled:[!1],focusedLine:0,isDialogVisible:!1,isPause:!1,pauseTime:3,time:0,timeStr:"",percentage:0,clock:"",correctRate:0,score:0}},computed:{totalTime:function(){return 60*this.$store.state.testInfo.totalTestTime},speed:function(){return parseInt(this.typedWordNum/(this.totalTime-this.time)*60)},totalWordNum:function(){for(var t=0,e=0;e<this.lineList.length;e++)t+=this.lineList[e].length;return t},typedWordNum:function(){for(var t=0,e=0;e<this.inputList.length;e++)t+=this.inputList[e].length;return t},testInfo:function(){return{speed:this.speed,time:this.totalTime-this.time,percentage:this.percentage,correctRate:this.correctRate,score:this.score,type:this.$store.state.article["type"]}}},components:{Recorder:o["a"],SubmitDialog:f},created:function(){""==this.$store.state.article["title"]&&this.$router.push("/typing")},mounted:function(){if(document.oncontextmenu=new Function("event.returnValue=false"),document.onselectstart=new Function("event.returnValue=false"),history.pushState(null,null,document.URL),window.addEventListener("popstate",(function(){history.pushState(null,null,document.URL)})),"En"==this.articleType)for(var t=Math.floor(document.getElementsByClassName("article")[0].clientWidth/12.5),e=0,s=this.article.split("\r\n"),i=0;i<s.length;i++){for(var n=s[i].trim().split(" "),o=0;o<n.length;o++)this.lineList[e].length+n[o].length<=t?0==this.lineList[e].length?this.lineList[e]+=n[o]:this.lineList[e]+=" "+n[o]:(e++,this.lineList.push(n[o]));i!=s.length-1&&(e++,this.lineList.push(""))}else{t=Math.floor(document.getElementsByClassName("article")[0].clientWidth/25-2),i=0,e=0;while(i<this.article.length)"\n"==this.article[i]&&this.lineList[e].length?(this.lineList[e]=this.lineList[e].trim(),this.lineList.push(""),e++):"\n"!=this.article[i]&&(this.lineList[e]+=this.article[i],this.lineList[e].length==t&&(this.lineList[e]=this.lineList[e].trim(),this.lineList.push(""),e++)),i++}for(i=0;i<this.lineList.length;i++){this.inputList.push(""),this.isDisabled.push(!0),this.isError.push([]),this.isRight.push([]);for(o=0;o<this.lineList[i].length;o++)this.isError[i].push(!1),this.isRight[i].push(!1)}this.$refs.inputRef[this.focusedLine].focus(),this.countDown(!0)},methods:{focus_line:function(t){this.focusedLine=t},key_delete:function(){this.focusedLine-1>=0&&0==this.inputList[this.focusedLine].length&&this.$refs.inputRef[this.focusedLine-1].focus()},key_enter:function(){var t=this.focusedLine;this.inputList[t]==this.lineList[t]&&this.$refs.inputRef[this.focusedLine+1].focus()},timePause:function(){var t=this;if(this.pauseTime>0)if(this.isPause=!this.isPause,this.isPause){clearInterval(this.clock);var e=0;while(e<this.isDisabled.length&&0==this.isDisabled[e])this.isDisabled[e]=!0,e++}else{this.pauseTime--;e=0;while(e<this.isDisabled.length&&""!=this.inputList[e])this.isDisabled[e]=!1,e++;e>0&&e<this.inputList.length&&this.inputList[e-1].length==this.lineList[e-1].length&&(this.isDisabled[e]=!1,this.focusedLine=e),this.isDisabled[0]=!1,this.countDown(!1),this.$nextTick((function(){t.$refs.inputRef[t.focusedLine].focus()}))}},countDown:function(t){var e=this;t&&(this.time=this.totalTime),this.clock=setInterval((function(){var t=0,s=0;e.time>0?(t=Math.floor(e.time/60),s=Math.floor(e.time)-60*t,e.time--):e.confirmInfo(!1),t<=9&&(t="0"+t),s<=9&&(s="0"+s),e.timeStr=t+"分"+s+"秒"}),1e3)},confirmInfo:function(t){clearInterval(this.clock),this.$refs.inputRef[this.focusedLine].blur();var e=this.inputList[this.focusedLine].length-1;e=e<this.lineList[this.focusedLine].length-1?e:this.lineList[this.focusedLine].length;while(this.inputList[this.focusedLine][e]!==this.lineList[this.focusedLine][e])e--;if(this.inputList[this.focusedLine]=this.inputList[this.focusedLine].substr(0,e+1),!1===t){for(var s=0,i=0,n=0;n<this.inputList.length;n++)for(e=0;e<this.inputList[n].length;e++)this.inputList[n][e]===this.lineList[n][e]&&s++,i++;this.correctRate=0!=i?Math.floor(s/i*1e3)/10:0}else this.correctRate=100;this.score=this.correctRate*this.speed/100,this.isDialogVisible=!0}},watch:{inputList:function(t,e){var s=this,i=Math.floor(this.typedWordNum/this.totalWordNum*1e3)/10;this.percentage=i<=100?i:100;for(var n=this.focusedLine,o=0;o<this.lineList[n].length;o++)o<e[n].length?e[n][o]===this.lineList[n][o]?(this.isError[n][o]=!1,this.isRight[n][o]=!0):(this.isError[n][o]=!0,this.isRight[n][o]=!1):(this.isError[n][o]=!1,this.isRight[n][o]=!1);if(e[n].length===this.lineList[n].length){this.focusedLine+1!==this.lineList.length&&(this.focusedLine++,this.isDisabled[this.focusedLine]=!1,this.$nextTick((function(){s.$refs.inputRef[s.focusedLine].focus()})));var r=!0;for(o=0;o<this.lineList.length;o++)if(this.lineList[o]!==this.inputList[o]){r=!1;break}r&&this.confirmInfo(!0)}}},destroyed:function(){document.oncontextmenu=new Function("event.returnValue=true"),document.onselectstart=new Function("event.returnValue=true")}},d=p,m=(s("245f"),Object(h["a"])(d,i,n,!1,null,"4cdf151a",null));e["default"]=m.exports},"6d7e":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:{fixedClass:t.isFixed}},[s("el-card",{staticClass:"info",attrs:{shadow:"always","body-style":{padding:"1px 10px"}}},[s("el-row",[s("el-col",{attrs:{span:6}},["Cn"===t.unit?s("el-tooltip",{attrs:{effect:"dark",content:"Words Per Minute",placement:"bottom"}},[s("span",[t._v("速度："+t._s(t.speed)+" WPM(字/分)")])]):s("el-tooltip",{attrs:{effect:"dark",content:"Keystrokes Per Minute",placement:"bottom"}},[s("span",[t._v("速度："+t._s(t.speed)+" KPM(键/分)")])])],1),s("el-col",{attrs:{span:6}},[s("span",[t._v("时间："+t._s(t.time))])]),s("el-col",{directives:[{name:"show",rawName:"v-show",value:this.$store.state.isPractice,expression:"this.$store.state.isPractice"}],attrs:{span:6}},[s("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.timePause()}}},[t._v(t._s(this.isPause?"开始":"暂停"))]),s("span",[t._v(" 还可以暂停"+t._s(t.pauseTime)+"次")])],1),s("el-col",{attrs:{span:this.$store.state.isPractice?6:12}},[s("el-progress",{attrs:{"text-inside":!0,"stroke-width":28,percentage:t.percentage}})],1)],1)],1)],1)},n=[],o={name:"Recorder",props:["speed","unit","time","percentage","isPause","pauseTime"],data:function(){return{isFixed:!1}},mounted:function(){window.addEventListener("scroll",this.handleScroll)},methods:{handleScroll:function(){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,e=document.querySelector(".info").offsetTop;this.isFixed=t>e},timePause:function(){this.$emit("timePause")}},destroyed:function(){window.removeEventListener("scroll",this.handleScroll)}},r=o,l=(s("a4d5"),s("2877")),a=Object(l["a"])(r,i,n,!1,null,"0b37b741",null);e["a"]=a.exports},a4d5:function(t,e,s){"use strict";var i=s("cdf0"),n=s.n(i);n.a},c7aa:function(t,e,s){},cdf0:function(t,e,s){}}]);
//# sourceMappingURL=Article.2bbeb8ba.js.map